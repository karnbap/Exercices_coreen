<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CorÃ©en â€” Nombres | Explications + Warming up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../assets/style.css">
  <style>
    body{font-family:'Poppins','Noto Sans KR',sans-serif;}
    .quiz-container{max-width:860px;margin:2rem auto;padding:2rem;background:#f9fafb;border-radius:1rem;box-shadow:0 10px 15px -3px rgba(0,0,0,.08),0 4px 6px -2px rgba(0,0,0,.04)}
    .btn{padding:.75rem 1.25rem;border-radius:.65rem;font-weight:600;cursor:pointer;transition:all .2s;border:none}
    .btn-primary{background:#3b82f6;color:#fff}.btn-primary:hover{background:#2563eb}
    .btn-sound{background:#10b981;color:#fff}.btn-sound:hover{background:#059669}
    .small-muted{ font-size:.9rem; color:#64748b; }
    .readable { line-height: 1.9; }
    .readable p { margin-top: 0.9rem; margin-bottom: 0.9rem; }
    .readable .kicker { font-size: .96rem; letter-spacing: .02em; color:#64748b; }
    .info-card { background:#fff; border:1px solid #e5e7eb; border-radius:1rem; padding:1.15rem 1.25rem; box-shadow:0 1px 2px rgba(16,24,40,.06); }
    .info-card h3 { font-weight:700; font-size:1.125rem; color:#0f172a; margin-bottom:.5rem; }
    .callout { background:#fef9c3; border:1px solid #fde68a; color:#92400e; padding:.9rem 1rem; border-radius:.85rem; }
    .soft-divider { height:1px; margin:1.35rem 0; background:linear-gradient(to right, transparent, #e5e7eb, transparent); }
    .table-soft th { background:#f8fafc; color:#0f172a; }
    .table-soft th, .table-soft td { padding:1rem; }
    .brand-tag{position:fixed;right:16px;bottom:12px;font-size:12px;color:#9ca3af}
  </style>
</head>
<body class="bg-gray-50">

  <!-- ì„¤ëª… -->
  <div class="min-h-screen flex flex-col items-center justify-center text-center p-6">
    <div class="max-w-3xl w-full mx-auto readable">
      <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-3 leading-tight">Exercice : Les Nombres CorÃ©ens ğŸ”¢</h1>
      <p class="kicker mb-6">ìˆœìˆ˜ í•œêµ­ì–´ / Natifs vs í•œìì–´ / Hanja-corÃ©ens</p>

      <div class="grid md:grid-cols-2 gap-6 text-left">
        <div class="info-card">
          <h3>1ï¸âƒ£ Petite explication / ê°„ë‹¨ ì„¤ëª…</h3>
          <div class="callout">ğŸ‘‰ Â« í•œì = chinois(ì–¸ì–´) Â»ê°€ ì•„ë‹ˆì—ìš”! Hanja=ë¬¸ì ì²´ê³„, Chinois=ì–¸ì–´.</div>
          <ul class="list-disc list-inside mt-3 space-y-1.5">
            <li><strong>í•œì (Hanja)</strong> = systÃ¨me dâ€™Ã©criture</li>
            <li><strong>Chinois</strong> = langue</li>
          </ul>
        </div>
        <div class="info-card">
          <h3>2ï¸âƒ£ Deux systÃ¨mes / ë‘ ê°€ì§€ ìˆ«ì</h3>
          <p class="mb-2"><strong>ìˆœìˆ˜ í•œêµ­ì–´</strong> â†” <strong>í•œìì–´</strong></p>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-3 rounded-lg bg-blue-50 border border-blue-200">
              <div class="font-semibold text-blue-900">Natifs</div>
              <div class="text-xl font-bold">í•˜ë‚˜, ë‘˜, ì…‹â€¦</div>
              <div class="small-muted">Ã‚ge, personnes, objetsâ€¦</div>
            </div>
            <div class="p-3 rounded-lg bg-green-50 border border-green-200">
              <div class="font-semibold text-green-900">Hanja-corÃ©ens</div>
              <div class="text-xl font-bold">ì¼, ì´, ì‚¼â€¦</div>
              <div class="small-muted">Dates, argent, minutesâ€¦</div>
            </div>
          </div>
        </div>
        <div class="info-card md:col-span-2">
          <h3>âš¡ Exception & Tendance</h3>
          <ul class="list-disc list-inside space-y-1.5">
            <li>Heures(ì‹œ) â†’ <b>natifs</b> Â· Minutes(ë¶„) â†’ <b>Hanja-corÃ©ens</b></li>
            <li>Â« 1 h = 60 min Â» ì²´ê³„ ì´í›„ ì‹œ=natifs / ë¶„=Hanja</li>
          </ul>
        </div>
        <div class="info-card md:col-span-2">
          <h3>âœ… RÃ©sumÃ© / ìš”ì•½</h3>
          <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse text-sm table-soft">
              <thead>
                <tr>
                  <th class="border border-slate-200">SystÃ¨me / ì²´ê³„</th>
                  <th class="border border-slate-200">Usage / ìš©ë„</th>
                  <th class="border border-slate-200">Exemples / ì˜ˆ</th>
                </tr>
              </thead>
              <tbody>
                <tr class="odd:bg-white even:bg-gray-50">
                  <td class="border border-slate-200 font-semibold">ìˆœìˆ˜ í•œêµ­ì–´ / Natifs</td>
                  <td class="border border-slate-200">Compter librement, classificateurs, durÃ©es libres</td>
                  <td class="border border-slate-200">
                    í•œ ë‹¬, ë‘ ë‹¬ / í•œ ê°œ, ë‘ ëª…, ì„¸ ì”, í•œ ê¶Œ / í•œ ì‹œ, ë‘ ì‹œ
                  </td>
                </tr>
                <tr class="odd:bg-white even:bg-gray-50">
                  <td class="border border-slate-200 font-semibold">í•œìì–´ / Hanja-corÃ©ens</td>
                  <td class="border border-slate-200">Valeurs Â« Ã©crites Â» (calendrier, montre, monnaieâ€¦)</td>
                  <td class="border border-slate-200">
                    1ì›”, 2ì›” / 10ë¶„, 30ì´ˆ / 2025ë…„ 9ì›” 7ì¼, 1,000ì› / 3ì¸µ, 302í˜¸
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="soft-divider"></div>
    </div>
  </div>

  <!-- ì›Œë°ì—… (ë“£ê¸° 0.9ë°°ì† + ë…¹ìŒÂ·í‰ê°€) -->
  <div class="quiz-container">
    <h2 class="text-3xl font-bold text-slate-800 mb-2 text-center">MÃ©thode 5Ã—5 ğŸ—£ï¸ / 5ê°œì”© í›ˆë ¨ë²•</h2>
    <p class="text-lg text-slate-600 mb-8 text-center">Ã‰couter â†’ RÃ©pÃ©ter â†’ <b>Enregistrer & Ã‰valuer</b> / ë“£ê³  ë”°ë¼ ë§í•œ ë’¤ <b>ë…¹ìŒÂ·í‰ê°€</b></p>

    <div class="space-y-6">
      <div class="p-4 bg-white rounded-lg shadow-sm">
        <div class="flex items-center justify-between">
          <p class="font-semibold text-lg text-slate-700">Natifs (1â€“5) : <span class="text-gray-500">í•˜ë‚˜, ë‘˜, ì…‹, ë„·, ë‹¤ì„¯</span></p>
          <button class="btn btn-sound" onclick="onPlayPause('í•˜ë‚˜, ë‘˜, ì…‹, ë„·, ë‹¤ì„¯','alloy',{ speed:0.9 })"><i class="fas fa-play"></i></button>
        </div>
        <div id="wu-pronun-1" class="mt-3 p-3 rounded-lg border border-indigo-200 bg-indigo-50/60"></div>
      </div>

      <div class="p-4 bg-white rounded-lg shadow-sm">
        <div class="flex items-center justify-between">
          <p class="font-semibold text-lg text-slate-700">Natifs (6â€“10) : <span class="text-gray-500">ì—¬ì„¯, ì¼ê³±, ì—¬ëŸ, ì•„í™‰, ì—´</span></p>
          <button class="btn btn-sound" onclick="onPlayPause('ì—¬ì„¯, ì¼ê³±, ì—¬ëŸ, ì•„í™‰, ì—´','shimmer',{ speed:0.9 })"><i class="fas fa-play"></i></button>
        </div>
        <div id="wu-pronun-2" class="mt-3 p-3 rounded-lg border border-indigo-200 bg-indigo-50/60"></div>
      </div>

      <div class="p-4 bg-white rounded-lg shadow-sm">
        <div class="flex items-center justify-between">
          <p class="font-semibold text-lg text-slate-700">Hanja (1â€“5) : <span class="text-gray-500">ì¼, ì´, ì‚¼, ì‚¬, ì˜¤</span></p>
          <button class="btn btn-sound" onclick="onPlayPause('ì¼, ì´, ì‚¼, ì‚¬, ì˜¤','alloy',{ speed:0.9 })"><i class="fas fa-play"></i></button>
        </div>
        <div id="wu-pronun-3" class="mt-3 p-3 rounded-lg border border-indigo-200 bg-indigo-50/60"></div>
      </div>

      <div class="p-4 bg-white rounded-lg shadow-sm">
        <div class="flex items-center justify-between">
          <p class="font-semibold text-lg text-slate-700">Hanja (6â€“10) : <span class="text-gray-500">ìœ¡, ì¹ , íŒ”, êµ¬, ì‹­</span></p>
          <button class="btn btn-sound" onclick="onPlayPause('ìœ¡, ì¹ , íŒ”, êµ¬, ì‹­','alloy',{ speed:0.9 })"><i class="fas fa-play"></i></button>
        </div>
        <div id="wu-pronun-4" class="mt-3 p-3 rounded-lg border border-indigo-200 bg-indigo-50/60"></div>
      </div>
    </div>

    <div class="mt-8 text-center">
      <a href="./numbers-exercises.html" class="btn btn-primary text-lg">Commencer l'exercice ! (ì—°ìŠµë¬¸ì œ ì‹œì‘!) <i class="fas fa-arrow-right"></i></a>
    </div>
  </div>

  <div class="brand-tag">made by ì„±ì¼, Pongdang Â· Lapeace29@gmail.com</div>

  <!-- ê¸°ë³¸ TTS/Functions ì„¤ì • -->
  <script>
    window.PONGDANG_TTS = window.PONGDANG_TTS || { provider: 'openai' };
    window.PONGDANG_FN_BASE = window.PONGDANG_FN_BASE || '/.netlify/functions';
    // ì „ì‚¬/ìˆ«ìì¹˜í™˜ ë¬¸êµ¬ ìˆ¨ê¸°ê¸°(í´ë¼ì´ì–¸íŠ¸ê°€ ì§€ì› ì•ˆí•˜ë©´ ì•„ë˜ scrubberê°€ ì œê±°)
    window.PRONUN_OPTIONS = { hideTranscript: true, hideNumericSwap: true };
  </script>
  <script src="../assets/pronun-utils.js"></script>
  <script src="../assets/pronun-vowel-middleware.js"></script>
  <script src="../assets/pronun-client.js"></script>

  <script>
    const FN_BASE = (window.PONGDANG_FN_BASE || '/.netlify/functions');
    let currentAudio=null,currentBlobUrl=null,currentFetchAbort=null,isPlayingOrFetching=false,audioClickLocked=false;
    const VOICE_MAP={openai:{default:"alloy",alloy:"alloy",shimmer:"verse"},google:{default:"ko-KR-Standard-A",alloy:"ko-KR-Standard-A",shimmer:"ko-KR-Standard-B"}};
    const mapVoice=(p,v)=> (VOICE_MAP[p]||{} )[v] || (VOICE_MAP[p]||{}).default || v;

    function base64ToBlob(b64,mime='audio/mpeg'){const c=b64.includes(',')?b64.split(',')[1]:b64;const s=atob(c);const a=new Uint8Array(s.length);for(let i=0;i<s.length;i++)a[i]=s.charCodeAt(i);return new Blob([a],{type:mime});}
    function updatePlayBtnUI(btn,playing){ if(!btn) return; btn.innerHTML = playing? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>'; }
    async function onPlayPause(text,voice='alloy',opts={}){
      const btn=event?.currentTarget;
      if(audioClickLocked||isPlayingOrFetching){ if(currentAudio){ try{ if(currentAudio.paused){ await currentAudio.play(); updatePlayBtnUI(btn,true);} else { currentAudio.pause(); updatePlayBtnUI(btn,false);} }catch(_){} } return;}
      audioClickLocked=true; setTimeout(()=>audioClickLocked=false,220);
      try{
        if(currentAudio && currentAudio.src && currentAudio._meta===text){ if(currentAudio.paused){ await currentAudio.play(); updatePlayBtnUI(btn,true);} else { currentAudio.pause(); updatePlayBtnUI(btn,false);} return; }
        isPlayingOrFetching=true;
        if(currentFetchAbort){ try{currentFetchAbort.abort();}catch(_){}
        } if(currentAudio){ try{currentAudio.pause();}catch(_){}
        }
        const ac=new AbortController(); currentFetchAbort=ac;
        const primary=(window.PONGDANG_TTS?.provider)||'openai';
        const payload={ text, voice: mapVoice(primary,voice), provider: primary, speed:(opts.speed ?? opts.speakingRate) };
        const res=await fetch(`${FN_BASE}/generate-audio`,{method:'POST',headers:{'Content-Type':'application/json','Cache-Control':'no-store'},body:JSON.stringify(payload),signal:ac.signal});
        if(!res.ok){ throw new Error('TTS error '+res.status); }
        const data=await res.json();
        let src=null;
        if(data.audioBase64||data.audioContent){ const blob=base64ToBlob(data.audioBase64||data.audioContent,data.mimeType||'audio/mpeg'); src=URL.createObjectURL(blob); currentBlobUrl=src; }
        else if(data.audioUrl){ src=data.audioUrl; }
        const audio=new Audio(src); currentAudio=audio; audio._meta=text;
        audio.addEventListener('playing',()=>updatePlayBtnUI(btn,true));
        audio.addEventListener('pause',()=>updatePlayBtnUI(btn,false));
        audio.addEventListener('ended',()=>updatePlayBtnUI(btn,false));
        await audio.play();
      }catch(e){ alert('ì˜¤ë””ì˜¤ ìƒì„±/ì¬ìƒ ì˜¤ë¥˜. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }
      finally{ isPlayingOrFetching=false; }
    }

    // Pronun mount + â€œì „ì‚¬â€ë¥˜ ë¬¸êµ¬ ì œê±° ìŠ¤í¬ëŸ¬ë²„
    function scrubPronun(container){
      if(!container) return;
      const killWords=['ì „ì‚¬','transcription','transcrit'];
      const sweep=()=>{
        const nodes=container.querySelectorAll('*');
        nodes.forEach(n=>{
          if(n.childNodes && n.childNodes.length){
            n.childNodes.forEach(c=>{
              if(c.nodeType===3 && killWords.some(k=>c.textContent?.toLowerCase().includes(k))){
                c.textContent='';
              }
            });
          }
        });
      };
      sweep();
      const mo=new MutationObserver(sweep);
      mo.observe(container,{childList:true,subtree:true});
    }

    document.addEventListener('DOMContentLoaded',()=>{
      const blocks=[
        ['wu-pronun-1','í•˜ë‚˜, ë‘˜, ì…‹, ë„·, ë‹¤ì„¯'],
        ['wu-pronun-2','ì—¬ì„¯, ì¼ê³±, ì—¬ëŸ, ì•„í™‰, ì—´'],
        ['wu-pronun-3','ì¼, ì´, ì‚¼, ì‚¬, ì˜¤'],
        ['wu-pronun-4','ìœ¡, ì¹ , íŒ”, êµ¬, ì‹­'],
      ];
      blocks.forEach(([id,text])=>{
        const el=document.getElementById(id);
        if(el && window.Pronun){
          Pronun.mount(el,{
            getReferenceText:()=>text,
            isKoCorrect:()=>true,
            onResult:()=>{}
          });
          scrubPronun(el);
        }
      });
    });
  </script>

  <div class="brand-tag">made by ì„±ì¼, Pongdang Â· Lapeace29@gmail.com</div>
</body>
</html>
