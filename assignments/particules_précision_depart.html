<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercice : particules de prÃ©cision et de dÃ©part</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', 'Noto Sans KR', sans-serif; }
        .quiz-container { max-width: 800px; margin: 2rem auto; padding: 2rem; background-color: #f9fafb; border-radius: 1rem; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .btn { transition: all 0.3s ease; }
        .btn-primary { background-color: #3b82f6; color: white; }
        .btn-primary:hover:not(:disabled) { background-color: #2563eb; }
        .btn-secondary { background-color: #6b7280; color: white; }
        .btn-secondary:hover { background-color: #4b5563; }
        .btn-audio { background-color: #f59e0b; color: white; }
        .btn-audio:hover:not(:disabled) { background-color: #d97706; }
        .btn-audio:disabled { background-color: #f59e0b; opacity: 0.7; cursor: not-allowed; }
        .feedback { font-size: 1rem; font-weight: bold; margin-top: 0.5rem; padding: 0.75rem; border-radius: 0.5rem; display: none; }
        .feedback.correct { color: #16a34a; background-color: #dcfce7; }
        .feedback.incorrect { color: #dc2626; background-color: #fee2e2; }
        .answer-key { background-color: #eef2ff; border: 1px solid #c7d2fe; padding: 0.75rem; border-radius: 0.5rem; color: #4338ca; font-weight: 500; }
        input[type="text"] { border: 2px solid #d1d5db; border-radius: 0.5rem; padding: 0.5rem 0.75rem; transition: border-color 0.3s; }
        input[type="text"]:focus { outline: none; border-color: #3b82f6; }
        .tip-box { background-color: #fefce8; border-left: 4px solid #facc15; padding: 1rem; margin-top: 1.5rem; }
        .hint-box { font-size: 0.9rem; color: #4b5563; background-color: #f3f4f6; padding: 0.75rem; border-radius: 0.5rem; margin-top: 0.75rem; }
        .analysis-box { background-color: #f0f9ff; border: 1px solid #bae6fd; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; }
        .question-block { padding: 1.5rem; border: 1px solid #e5e7eb; border-radius: 0.75rem; background-color: white; }
        .section-title { border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem; }
    </style>
</head>
<body class="bg-gray-50">

    <div class="quiz-container">
        <div class="text-center mb-8">
            <a href="/index.html" class="text-indigo-600 hover:text-indigo-800 mb-4 block">&larr; Retour Ã  la liste</a>
            <h1 class="text-4xl font-bold text-gray-800">ì—°ìŠµ ë¬¸ì œ: 'ì—' vs 'ì—ì„œ' (ì‹¬í™”)</h1>
            <p class="text-gray-600 mt-2">Exercices pour maÃ®triser les usages variÃ©s de 'ì—' et 'ì—ì„œ'.</p>
        </div>

        <div class="mb-12 p-6 bg-white rounded-lg shadow-sm">
             <h2 class="text-2xl font-semibold text-blue-700 mb-4">ğŸ“Œ Concepts ClÃ©s : 'ì—' vs 'ì—ì„œ'</h2>
             <table class="w-full text-left border-collapse">
                 <thead>
                     <tr>
                         <th class="border-b-2 p-4 text-lg font-bold text-gray-700">Particule</th>
                         <th class="border-b-2 p-4 text-lg font-bold text-gray-700">Concept Principal</th>
                     </tr>
                 </thead>
                 <tbody>
                     <tr class="hover:bg-blue-50">
                         <td class="p-4 border-b font-mono text-xl text-blue-600 align-top">ì—</td>
                         <td class="p-4 border-b text-gray-600">
                             <strong class="text-lg text-gray-800">Lie une information au verbe.</strong>
                             <p class="mt-2">SpÃ©cifie des informations complÃ©mentaires comme le <strong>temps</strong>, le <strong>lieu (statique/destination)</strong>, ou le <strong>prix</strong>.</p>
                             <em class="block mt-2 text-gray-500">Ex: <strong>3ì‹œì—</strong> ë§Œë‚˜ìš” (Temps), <strong>ì§‘ì—</strong> ìˆì–´ìš” (Lieu), í•œ ê°œ<strong>ì—</strong> ì²œ ì› (Prix).</em>
                         </td>
                     </tr>
                     <tr class="hover:bg-amber-50">
                         <td class="p-4 border-b font-mono text-xl text-amber-600 align-top">ì—ì„œ</td>
                         <td class="p-4 border-b text-gray-600">
                            <strong class="text-lg text-gray-800">Indique le point de dÃ©part.</strong>
                            <p class="mt-2">Marque l'origine d'une <strong>action</strong> (lieu oÃ¹ elle se dÃ©roule), d'un <strong>trajet</strong>, ou d'un <strong>changement d'Ã©tat</strong>.</p>
                            <em class="block mt-2 text-gray-500">Ex: <strong>ë„ì„œê´€ì—ì„œ</strong> ê³µë¶€í•´ìš” (Action), <strong>ì„œìš¸ì—ì„œ</strong> ì™”ì–´ìš” (Trajet), <strong>í•™ìƒì—ì„œ</strong> ì„ ìƒë‹˜ì´ ë˜ì—ˆì–´ìš” (Ã‰tat).</em>
                         </td>
                     </tr>
                 </tbody>
             </table>
             <div class="tip-box">
                 <p class="font-bold text-lg text-yellow-800 flex items-center"><i class="fas fa-lightbulb mr-3"></i>L'astuce pour ne plus se tromper !</p>
                 <p class="mt-2 text-gray-700">Quand on utilise 'ì—', on connecte une information (lieu, temps, prix) au verbe.</p>
                 <p class="mt-2 text-gray-700">Mais si le verbe dÃ©crit une <strong>ACTION</strong>, on ajoute <strong>"ì„œ"</strong> Ã  "ì—" pour montrer le point de dÃ©part de cette action.</p>
                 <ul class="list-disc list-inside mt-2 pl-2 text-gray-700">
                     <li><strong>ì—</strong> = Lie la destination / le lieu Ã  un verbe d'Ã©tat.</li>
                     <li><strong>ì— + ì„œ</strong> = Montre qu'une <strong>action</strong> se dÃ©roule Ã  cet endroit.</li>
                 </ul>
                 <p class="mt-3 font-semibold text-gray-800">Donc, quand un lieu apparaÃ®t, demandez-vous : le verbe dÃ©crit une <strong>action</strong> ou un <strong>Ã©tat</strong> ? C'est la clÃ© !</p>
             </div>
        </div>
        
        <div id="quiz-sections">
            <!-- Les sections seront gÃ©nÃ©rÃ©es ici -->
        </div>
    </div>

    <script>
        const questions = {
            read: [
                { id: 'read1', text: 'ì €ëŠ” ì§€ê¸ˆ íšŒì‚¬( ? ) ìˆì–´ìš”.', verb: 'ìˆë‹¤', verbType: 'state', correctAnswer: 'ì—', explanation: "'ìˆë‹¤' (Ãªtre) est un verbe d'Ã©tat. Il dÃ©crit oÃ¹ quelque chose se trouve, pas une action qui s'y dÃ©roule.", hint: "<strong>Vocabulaire:</strong> ì €(je), ì§€ê¸ˆ(maintenant), íšŒì‚¬(entreprise), ìˆë‹¤(Ãªtre)" },
                { id: 'read2', text: 'ë™ìƒì´ ê³µì›( ? ) ìš´ë™í•´ìš”.', verb: 'ìš´ë™í•˜ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "'ìš´ë™í•˜ë‹¤' (faire de l'exercice) est une action. L'action se dÃ©roule DANS le parc.", hint: "<strong>Vocabulaire:</strong> ë™ìƒ(frÃ¨re/sÅ“ur), ê³µì›(parc), ìš´ë™í•˜ë‹¤(faire de l'exercice)" },
                { id: 'read3', text: 'ìš°ë¦¬ëŠ” ë‚´ì¼ ë¶€ì‚°( ? ) ê°ˆ ê±°ì˜ˆìš”.', verb: 'ê°€ë‹¤', verbType: 'destination', correctAnswer: 'ì—', explanation: "'ê°€ë‹¤' (aller) est un verbe de mouvement. 'ì—' indique la destination.", hint: "<strong>Vocabulaire:</strong> ìš°ë¦¬(nous), ë‚´ì¼(demain), ë¶€ì‚°(Busan), ê°€ë‹¤(aller)" },
                { id: 'read4', text: 'ì €ëŠ” ì˜¤í›„ 3ì‹œ( ? ) ì¹œêµ¬ë¥¼ ë§Œë‚˜ìš”.', verb: 'ë§Œë‚˜ë‹¤', verbType: 'time', correctAnswer: 'ì—', explanation: "Pour indiquer un moment prÃ©cis dans le temps, on utilise toujours 'ì—'.", hint: "<strong>Vocabulaire:</strong> ì˜¤í›„(aprÃ¨s-midi), ì‹œ(heure), ì¹œêµ¬(ami), ë§Œë‚˜ë‹¤(rencontrer)" },
                { id: 'read5', text: 'ê³ ì–‘ì´ê°€ ì˜ì ìœ„( ? ) ìê³  ìˆì–´ìš”.', verb: 'ìê³  ìˆë‹¤', verbType: 'state', correctAnswer: 'ì—', explanation: "'ìê³  ìˆë‹¤' (Ãªtre en train de dormir) est considÃ©rÃ© comme un Ã©tat. Le chat est DANS un Ã©tat de sommeil SUR la chaise.", hint: "<strong>Vocabulaire:</strong> ê³ ì–‘ì´(chat), ì˜ì ìœ„(sur la chaise), ìë‹¤(dormir)" },
                { id: 'read6', text: 'ìš°ë¦¬ëŠ” ì–´ì œ ì˜í™”ê´€( ? ) ì˜í™”ë¥¼ ë´¤ì–´ìš”.', verb: 'ë³´ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "'ë³´ë‹¤' (regarder) un film est une action. L'action se dÃ©roule DANS le cinÃ©ma.", hint: "<strong>Vocabulaire:</strong> ì–´ì œ(hier), ì˜í™”ê´€(cinÃ©ma), ì˜í™”(film), ë³´ë‹¤(regarder)" },
                { id: 'read7', text: 'ì´ ë²„ìŠ¤ëŠ” ì„œìš¸( ? ) ì¶œë°œí•´ìš”.', verb: 'ì¶œë°œí•˜ë‹¤', verbType: 'origin', correctAnswer: 'ì—ì„œ', explanation: "'ì¶œë°œí•˜ë‹¤' (partir) indique un point de dÃ©part. 'ì—ì„œ' marque cette origine.", hint: "<strong>Vocabulaire:</strong> ë²„ìŠ¤(bus), ì„œìš¸(SÃ©oul), ì¶œë°œí•˜ë‹¤(partir)" },
                { id: 'read8', text: 'ì´ ì‚¬ê³¼ëŠ” 3ê°œ( ? ) 5,000ì›ì´ì—ìš”.', verb: 'ì´ë‹¤', verbType: 'price', correctAnswer: 'ì—', explanation: "Pour indiquer le prix par unitÃ©, on utilise 'ì—'.", hint: "<strong>Vocabulaire:</strong> ì‚¬ê³¼(pomme), ê°œ(unitÃ©), ì›(won)" },
                { id: 'read9', text: 'ì€í–‰( ? ) ëˆì„ ì°¾ì•˜ì–´ìš”.', verb: 'ì°¾ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "'ëˆì„ ì°¾ë‹¤' (retirer de l'argent) est une action qui se dÃ©roule DANS la banque.", hint: "<strong>Vocabulaire:</strong> ì€í–‰(banque), ëˆ(argent), ì°¾ë‹¤(retirer)" },
                { id: 'read10', text: 'íšŒì˜ëŠ” 10ì¸µ( ? ) ì—´ë¦´ ê±°ì˜ˆìš”.', verb: 'ì—´ë¦¬ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "'ì—´ë¦¬ë‹¤' (se tenir, avoir lieu) est une action/Ã©vÃ©nement qui se dÃ©roule AU 10Ã¨me Ã©tage.", hint: "<strong>Vocabulaire:</strong> íšŒì˜(rÃ©union), ì¸µ(Ã©tage), ì—´ë¦¬ë‹¤(se tenir)" }
            ],
            write: [
                { id: 'write1', text: 'ë°±í™”ì  ( ? ) ì˜·ì„ ìƒ€ì–´ìš”.', verb: 'ì‚¬ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "'ì‚¬ë‹¤' (acheter) est une action. L'achat a lieu DANS le grand magasin.", hint: "<strong>Vocabulaire:</strong> ë°±í™”ì (grand magasin), ì˜·(vÃªtement), ì‚¬ë‹¤(acheter)" },
                { id: 'write2', text: 'ì €ëŠ” í”„ë‘ìŠ¤ ( ? ) ì™”ì–´ìš”.', verb: 'ì˜¤ë‹¤', verbType: 'origin', correctAnswer: 'ì—ì„œ', explanation: "'ì˜¤ë‹¤' (venir) indique l'origine, le point de dÃ©part. On utilise 'ì—ì„œ'.", hint: "<strong>Vocabulaire:</strong> í”„ë‘ìŠ¤(France), ì˜¤ë‹¤(venir)" },
                { id: 'write3', text: 'ìˆ˜ì—…ì´ ëª‡ ì‹œ ( ? ) ëë‚˜ìš”?', verb: 'ëë‚˜ë‹¤', verbType: 'time', correctAnswer: 'ì—', explanation: "On demande un moment prÃ©cis dans le temps, donc on utilise 'ì—'.", hint: "<strong>Vocabulaire:</strong> ìˆ˜ì—…(cours), ëª‡ ì‹œ(quelle heure), ëë‚˜ë‹¤(se terminer)" },
                { id: 'write4', text: 'ì¹œêµ¬ê°€ ë„ì„œê´€ ( ? ) ì±…ì„ ë¹Œë ¸ì–´ìš”.', verb: 'ë¹Œë¦¬ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "'ë¹Œë¦¬ë‹¤' (emprunter) est une action qui se dÃ©roule DANS la bibliothÃ¨que.", hint: "<strong>Vocabulaire:</strong> ë„ì„œê´€(bibliothÃ¨que), ì±…(livre), ë¹Œë¦¬ë‹¤(emprunter)" },
                { id: 'write5', text: 'ì´ ë¹µì€ í•œ ê°œ ( ? ) 2ìœ ë¡œì˜ˆìš”.', verb: 'ì´ë‹¤', verbType: 'price', correctAnswer: 'ì—', explanation: "Pour indiquer le prix par unitÃ©, on utilise 'ì—'.", hint: "<strong>Vocabulaire:</strong> ë¹µ(pain), í•œ ê°œ(une piÃ¨ce), ìœ ë¡œ(euro)" },
                { id: 'write6', text: 'í•™ìƒ ( ? ) ì„ ìƒë‹˜ì´ ë˜ì—ˆì–´ìš”.', verb: 'ë˜ë‹¤', verbType: 'origin', correctAnswer: 'ì—ì„œ', explanation: "'ë˜ë‹¤' (devenir) peut indiquer un changement d'Ã©tat, oÃ¹ 'í•™ìƒ' est le point de dÃ©part. On utilise 'ì—ì„œ'.", hint: "<strong>Vocabulaire:</strong> í•™ìƒ(Ã©tudiant), ì„ ìƒë‹˜(professeur), ë˜ë‹¤(devenir)" },
                { id: 'write7', text: 'ì €ëŠ” í•œêµ­ ( ? ) ì‚´ì•„ìš”.', verb: 'ì‚´ë‹¤', verbType: 'action', correctAnswer: 'ì—ì„œ', explanation: "Bien que 'vivre' puisse sembler un Ã©tat, en corÃ©en, l'action de 'mener sa vie' se dÃ©roule DANS un lieu. On utilise donc 'ì—ì„œ'. C'est une exception importante!", hint: "<strong>Vocabulaire:</strong> í•œêµ­(CorÃ©e), ì‚´ë‹¤(vivre)" },
                { id: 'write8', text: '10ì‹œ ( ? ) 12ì‹œê¹Œì§€ íšŒì˜ê°€ ìˆì–´ìš”.', verb: 'ìˆë‹¤', verbType: 'origin', correctAnswer: 'ì—ì„œ', explanation: "La structure 'Aì—ì„œ Bê¹Œì§€' (de A Ã  B) est utilisÃ©e pour les pÃ©riodes de temps. 'ì—ì„œ' marque le dÃ©but.", hint: "<strong>Vocabulaire:</strong> ~ê¹Œì§€(jusqu'Ã ), íšŒì˜(rÃ©union)" },
                { id: 'write9', text: 'ì €ëŠ” ì €ë… ( ? ) ì•½ì†ì´ ìˆì–´ìš”.', verb: 'ìˆë‹¤', verbType: 'time', correctAnswer: 'ì—', explanation: "Pour indiquer une pÃ©riode de temps ('le soir'), on utilise 'ì—'.", hint: "<strong>Vocabulaire:</strong> ì €ë…(soir), ì•½ì†(rendez-vous)" },
                { id: 'write10', text: 'ë²½ ( ? ) ê·¸ë¦¼ì´ ê±¸ë ¤ ìˆì–´ìš”.', verb: 'ê±¸ë ¤ ìˆë‹¤', verbType: 'state', correctAnswer: 'ì—', explanation: "'ê±¸ë ¤ ìˆë‹¤' (Ãªtre accrochÃ©) est un verbe d'Ã©tat. Le tableau est DANS un Ã©tat statique SUR le mur.", hint: "<strong>Vocabulaire:</strong> ë²½(mur), ê·¸ë¦¼(tableau), ê±¸ë ¤ ìˆë‹¤(Ãªtre accrochÃ©)" }
            ],
            listen: [
                { id: 'listen1', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì¹œêµ¬ë¥¼ ì¹´í˜ì—ì„œ ë§Œë‚˜ìš”.', verb: 'ë§Œë‚˜ë‹¤', verbType: 'action', explanation: "'ë§Œë‚˜ë‹¤' (rencontrer) est une action qui se dÃ©roule DANS le cafÃ©.", hint: '<strong>Vocabulaire:</strong> ì¹œêµ¬(ami), ì¹´í˜(cafÃ©), ë§Œë‚˜ë‹¤(rencontrer)' },
                { id: 'listen2', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ìˆ˜ì—…ì€ ì„¸ ì‹œì— ì‹œì‘í•´ìš”.', verb: 'ì‹œì‘í•˜ë‹¤', verbType: 'time', explanation: "Indique un moment prÃ©cis dans le temps.", hint: '<strong>Vocabulaire:</strong> ìˆ˜ì—…(cours), ì‹œ(heure), ì‹œì‘í•˜ë‹¤(commencer)' },
                { id: 'listen3', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì €ëŠ” ì‹œì¥ì— ê°€ìš”.', verb: 'ê°€ë‹¤', verbType: 'destination', explanation: "'ê°€ë‹¤' (aller) indique une destination.", hint: '<strong>Vocabulaire:</strong> ì €(je), ì‹œì¥(marchÃ©), ê°€ë‹¤(aller)' },
                { id: 'listen4', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: '12ì›”ì— ëˆˆì´ ë§ì´ ì™€ìš”.', verb: 'ì˜¤ë‹¤', verbType: 'time', explanation: "Indique une pÃ©riode de temps.", hint: '<strong>Vocabulaire:</strong> 12ì›”(dÃ©cembre), ëˆˆ(neige), ì˜¤ë‹¤(venir/tomber)' },
                { id: 'listen5', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì§‘ì—ì„œ í•™êµê¹Œì§€ ê±¸ì–´ì„œ 10ë¶„ ê±¸ë ¤ìš”.', verb: 'ê±¸ë¦¬ë‹¤', verbType: 'origin', explanation: "La structure 'Aì—ì„œ Bê¹Œì§€' (de A Ã  B) marque un trajet.", hint: '<strong>Vocabulaire:</strong> ì§‘(maison), í•™êµ(Ã©cole), ê¹Œì§€(jusqu\'Ã ), ê±¸ì–´ì„œ(Ã  pied), ë¶„(minute), ê±¸ë¦¬ë‹¤(prendre du temps)' },
                { id: 'listen6', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì´ ì‹ë‹¹ì—ì„œ ìì£¼ ì €ë…ì„ ë¨¹ì–´ìš”.', verb: 'ë¨¹ë‹¤', verbType: 'action', explanation: "'ë¨¹ë‹¤' (manger) est une action qui se dÃ©roule DANS le restaurant.", hint: '<strong>Vocabulaire:</strong> ì‹ë‹¹(restaurant), ìì£¼(souvent), ì €ë…(dÃ®ner), ë¨¹ë‹¤(manger)' },
                { id: 'listen7', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì•½ì†ì€ 6ì‹œ 30ë¶„ì— ìˆì–´ìš”.', verb: 'ìˆë‹¤', verbType: 'time', explanation: "Indique Ã  quel moment le rendez-vous 'existe'.", hint: '<strong>Vocabulaire:</strong> ì•½ì†(rendez-vous), ì‹œ(heure), ë¶„(minute), ìˆë‹¤(avoir)' },
                { id: 'listen8', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì €ëŠ” íŒŒë¦¬ì—ì„œ íƒœì–´ë‚¬ì–´ìš”.', verb: 'íƒœì–´ë‚˜ë‹¤', verbType: 'origin', explanation: "'íƒœì–´ë‚˜ë‹¤' (naÃ®tre) indique une origine.", hint: '<strong>Vocabulaire:</strong> ì €(je), íŒŒë¦¬(Paris), íƒœì–´ë‚˜ë‹¤(naÃ®tre)' },
                { id: 'listen9', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì´ ê°€ë°©ì€ ì–¼ë§ˆì— ì‚¬ì…¨ì–´ìš”?', verb: 'ì‚¬ë‹¤', verbType: 'price', explanation: "Pour demander un prix, on utilise 'ì—'.", hint: '<strong>Vocabulaire:</strong> ê°€ë°©(sac), ì–¼ë§ˆ(combien), ì‚¬ë‹¤(acheter)' },
                { id: 'listen10', text: 'Ã‰coutez et Ã©crivez la phrase.', sentence: 'ì €ëŠ” ë§¤ì¼ ì•„ì¹¨ 8ì‹œì— íšŒì‚¬ì— ê°€ìš”.', verb: 'ê°€ë‹¤', verbType: 'time_destination', explanation: "Combine le temps ('8ì‹œì—') et la destination ('íšŒì‚¬ì—').", hint: '<strong>Vocabulaire:</strong> ë§¤ì¼(chaque jour), ì•„ì¹¨(matin), íšŒì‚¬(entreprise), ê°€ë‹¤(aller)' }
            ]
        };

        function renderAllSections() {
            const container = document.getElementById('quiz-sections');
            container.innerHTML = `
                <div class="mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 section-title">1. ì½ê¸° (Lecture) - 10ê°œ</h2>
                    <div class="space-y-6">${renderSection('read')}</div>
                    <button onclick="showAllAnswers('read')" class="btn btn-secondary mt-6 px-4 py-2 rounded-lg">Voir toutes les rÃ©ponses</button>
                </div>
                <div class="mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 section-title">2. ì“°ê¸° (Ã‰criture) - 10ê°œ</h2>
                    <div class="space-y-6">${renderSection('write')}</div>
                    <button onclick="showAllAnswers('write')" class="btn btn-secondary mt-6 px-4 py-2 rounded-lg">Voir toutes les rÃ©ponses</button>
                </div>
                <div class="mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 section-title">3. ë“£ê³  ì“°ê¸° (DictÃ©e) - 10ê°œ</h2>
                    <div class="space-y-6">${renderSection('listen')}</div>
                    <button onclick="showAllAnswers('listen')" class="btn btn-secondary mt-6 px-4 py-2 rounded-lg">Voir toutes les rÃ©ponses</button>
                </div>
            `;
        }
        
        function renderSection(sectionType) {
            let html = '';
            questions[sectionType].forEach((q, index) => {
                const isLocationQuestion = !['time', 'price', 'destination', 'time_destination'].includes(q.verbType);
                
                html += `<div class="question-block" id="block-${q.id}">`;
                html += `<p class="text-lg mb-2">${index + 1}. ${q.text.replace('( ? )', '(<span class="font-bold text-red-500">?</span>)')}</p>`;
                
                if (sectionType === 'listen') {
                    html += `<button onclick="speak(this, '${q.sentence}')" class="btn btn-audio px-4 py-2 rounded-lg mb-2"><i class="fas fa-play mr-2"></i> Ã‰couter</button>`;
                }
                
                html += `<div class="hint-box">${q.hint}</div>`;

                if (isLocationQuestion) {
                    html += `<div class="analysis-box mt-4">
                                <p class="font-semibold">Ã‰tape 1 : Le verbe '<strong>${q.verb}</strong>' dÃ©crit-il une action ou un Ã©tat/origine ?</p>
                                <div class="flex space-x-4 mt-2">
                                    <button onclick="checkAnalysis('${q.id}', 'action')" class="btn px-3 py-1 rounded-lg bg-blue-100 hover:bg-blue-200">Action</button>
                                    <button onclick="checkAnalysis('${q.id}', 'state')" class="btn px-3 py-1 rounded-lg bg-blue-100 hover:bg-blue-200">Ã‰tat / Origine</button>
                                </div>
                                <div id="feedback-analysis-${q.id}" class="feedback"></div>
                            </div>`;
                }

                html += `<div id="answer-section-${q.id}" class="${isLocationQuestion ? 'hidden' : ''} mt-4">`;
                
                if (sectionType === 'read') {
                    html += `<p class="font-semibold">${isLocationQuestion ? 'Ã‰tape 2 : ' : ''}Choisissez la bonne particule.</p>
                             <div class="mt-2 flex space-x-4">
                                <button onclick="checkChoiceAnswer('${q.id}', 'ì—')" class="btn px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300">ì—</button>
                                <button onclick="checkChoiceAnswer('${q.id}', 'ì—ì„œ')" class="btn px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300">ì—ì„œ</button>
                             </div>`;
                } else { // write or listen
                    html += `<p class="font-semibold">${isLocationQuestion ? 'Ã‰tape 2 : ' : ''}ComplÃ©tez la phrase et vÃ©rifiez.</p>
                             <div class="mt-2 flex items-center space-x-2">
                                <div class="w-full text-lg">${q.text.replace('( ? )', `<input type="text" id="${q.id}-input" class="w-20 text-center">`)}</div>
                                <button onclick="checkWrittenAnswer('${q.id}')" class="btn btn-primary px-4 py-2 rounded-lg">VÃ©rifier</button>
                             </div>`;
                }

                html += `<div id="feedback-${q.id}" class="feedback"></div>`;
                html += `</div>`; // Closing answer-section
                html += `<div id="answer-${q.id}" class="hidden mt-2 answer-key"></div>`;
                html += `</div>`; // Closing question-block
            });
            return html;
        }

        function checkAnalysis(questionId, userChoice) {
            const feedbackEl = document.getElementById(`feedback-analysis-${questionId}`);
            const answerSectionEl = document.getElementById(`answer-section-${questionId}`);
            const question = [...questions.read, ...questions.write].find(q => q.id === questionId);
            const correctType = (question.verbType === 'action' || question.verbType === 'origin') ? 'action' : 'state';

            feedbackEl.style.display = 'block';
            if (userChoice === correctType) {
                feedbackEl.innerHTML = `ğŸ‘ Correct ! Le verbe '<strong>${question.verb}</strong>' implique bien une <strong>${correctType}</strong>. Passez Ã  l'Ã©tape 2.`;
                feedbackEl.className = 'feedback correct';
                answerSectionEl.classList.remove('hidden');
            } else {
                feedbackEl.innerHTML = `ğŸ¤” Pas tout Ã  fait. ${question.explanation} RÃ©essayez !`;
                feedbackEl.className = 'feedback incorrect';
                answerSectionEl.classList.add('hidden');
            }
        }

        function checkChoiceAnswer(questionId, selectedAnswer) {
            const feedbackEl = document.getElementById(`feedback-${questionId}`);
            const question = questions.read.find(q => q.id === questionId);
            const isCorrect = question.correctAnswer === selectedAnswer;
            
            feedbackEl.style.display = 'block';
            if(isCorrect) {
                feedbackEl.innerHTML = 'Parfait ! ğŸ‰';
                feedbackEl.className = 'feedback correct';
            } else {
                feedbackEl.innerHTML = `Incorrect. La bonne rÃ©ponse est <strong>${question.correctAnswer}</strong>.`;
                feedbackEl.className = 'feedback incorrect';
            }
        }

        function checkWrittenAnswer(questionId) {
            const inputEl = document.getElementById(`${questionId}-input`);
            const feedbackEl = document.getElementById(`feedback-${questionId}`);
            const userAnswer = inputEl.value.trim();
            const question = [...questions.write, ...questions.listen].find(q => q.id === questionId);
            
            let isCorrect = false;
            if (questionId.startsWith('write')) {
                isCorrect = userAnswer.toLowerCase() === question.correctAnswer.toLowerCase();
            } else { // listen
                 isCorrect = userAnswer.replace(/[.\s!?]/g, '').toLowerCase() === question.sentence.replace(/[.\s!?]/g, '').toLowerCase();
            }
            
            feedbackEl.style.display = 'block';
            if (isCorrect) {
                feedbackEl.innerHTML = 'Parfait ! ğŸ‰';
                feedbackEl.className = 'feedback correct';
            } else {
                feedbackEl.innerHTML = 'Ce n\'est pas tout Ã  fait Ã§a. VÃ©rifiez la phrase.';
                feedbackEl.className = 'feedback incorrect';
            }
        }
        
        function showAllAnswers(sectionType = null) {
            const sections = sectionType ? [sectionType] : ['read', 'write', 'listen'];
            sections.forEach(section => {
                questions[section].forEach(q => {
                    const answerEl = document.getElementById(`answer-${q.id}`);
                    if (section === 'read') {
                        answerEl.innerHTML = `RÃ©ponse: ${q.text.replace('( ? )', `<strong>${q.correctAnswer}</strong>`)}`;
                    } else if (section === 'write') {
                        answerEl.innerHTML = `RÃ©ponse: ${q.text.replace('( ? )', `<strong>${q.correctAnswer}</strong>`)}`;
                    } else { // listen
                        answerEl.innerHTML = `RÃ©ponse: <strong>${q.sentence}</strong>`;
                    }
                    answerEl.classList.remove('hidden');
                });
            });
        }

        // --- Audio Generation Logic (Calls Netlify Function) ---
        function base64ToArrayBuffer(base64){const binaryString=window.atob(base64);const len=binaryString.length;const bytes=new Uint8Array(len);for(let i=0;i<len;i++){bytes[i]=binaryString.charCodeAt(i)}return bytes.buffer}function pcmToWav(pcmData,sampleRate){const pcm16=new Int16Array(pcmData);const header=new ArrayBuffer(44);const view=new DataView(header);function writeString(view,offset,string){for(let i=0;i<string.length;i++){view.setUint8(offset+i,string.charCodeAt(i))}}writeString(view,0,'RIFF');view.setUint32(4,36+pcm16.byteLength,true);writeString(view,8,'WAVE');writeString(view,12,'fmt ');view.setUint32(16,16,true);view.setUint16(20,1,true);const numChannels=1;view.setUint16(22,numChannels,true);view.setUint32(24,sampleRate,true);view.setUint32(28,sampleRate*numChannels*2,true);view.setUint16(32,numChannels*2,true);view.setUint16(34,16,true);writeString(view,36,'data');view.setUint32(40,pcm16.byteLength,true);return new Blob([header,pcm16],{type:'audio/wav'})}
        async function speak(button,text){const originalContent=button.innerHTML;const loadingSpinner=`<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Patientez...`;button.innerHTML=loadingSpinner;button.disabled=true;try{const response=await fetch('/.netlify/functions/generate-audio',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:text})});if(!response.ok){throw new Error(`Erreur du serveur: ${response.statusText}`)}const{audioData,mimeType}=await response.json();if(audioData&&mimeType?.startsWith("audio/")){const sampleRateMatch=mimeType.match(/rate=(\d+)/);const sampleRate=sampleRateMatch?parseInt(sampleRateMatch[1],10):24000;const pcmData=base64ToArrayBuffer(audioData);const pcm16=new Int16Array(pcmData);const wavBlob=pcmToWav(pcm16,sampleRate);const audioUrl=URL.createObjectURL(wavBlob);const audio=new Audio(audioUrl);audio.play();audio.onended=()=>{URL.revokeObjectURL(audioUrl);button.innerHTML=originalContent;button.disabled=false};audio.onerror=()=>{URL.revokeObjectURL(audioUrl);button.innerHTML=originalContent;button.disabled=false}}else{throw new Error("DonnÃ©es audio invalides reÃ§ues du serveur.")}}catch(error){console.error("Erreur lors de la gÃ©nÃ©ration de la parole:",error);alert("DÃ©solÃ©, une erreur est survenue lors de la gÃ©nÃ©ration de l'audio.");button.innerHTML=originalContent;button.disabled=false}}
        
        document.addEventListener('DOMContentLoaded', renderAllSections);
    </script>
</body>
</html>
