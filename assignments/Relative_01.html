<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercice Cor√©en : Structure de Phrase</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
        }
        .royal-blue {
            background-color: #0033a0; /* Royal Blue */
        }
        .gold-text {
            color: #ffbf00; /* Gold */
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .btn-primary {
            background-color: #0033a0; /* Royal Blue */
            border: 2px solid #002269;
        }
        .btn-primary:hover {
            background-color: #002269;
        }
        .btn-secondary {
            background-color: #6c757d;
            border: 2px solid #5a6268;
        }
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        .btn-gold {
            background-color: #ffbf00;
            color: #0033a0;
            border: 2px solid #e6ac00;
        }
        .btn-gold:hover {
            background-color: #e6ac00;
        }
        input[type="text"] {
            border: 2px solid #d1d5db;
            border-radius: 8px;
            padding: 8px 12px;
            width: 100%;
            transition: border-color 0.3s ease;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #0033a0;
        }
        .correct {
            border-color: #22c55e !important;
            background-color: #f0fff4;
        }
        .incorrect {
            border-color: #ef4444 !important;
            background-color: #fff1f2;
        }
        #result-message {
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <!-- En-t√™te -->
        <header class="text-center mb-8 p-6 royal-blue rounded-xl shadow-lg">
            <h1 class="text-3xl md:text-4xl font-bold gold-text">Exercice de Cor√©en üá∞üá∑</h1>
            <p class="text-white mt-2">D√©composer les phrases</p>
        </header>

        <!-- Section Nom -->
        <div class="card p-6 mb-8">
            <label for="student-name" class="block text-lg font-bold text-gray-700 mb-2">Entrez votre nom :</label>
            <input type="text" id="student-name" placeholder="Ex: C√©dric" class="text-lg">
        </div>

        <!-- √âtape 1 : Explication -->
        <div class="card p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üìù √âtape 1 : Comprendre la structure</h2>
            <div class="text-gray-600 space-y-3">
                <p>En cor√©en, comme en fran√ßais, une grande phrase est souvent faite de 2 petites phrases.</p>
                <ul class="list-disc list-inside mt-2 space-y-2">
                    <li><b>La premi√®re partie, c'est l'id√©e principale.</b> C'est le c≈ìur de la phrase (Qui fait quoi ?).</li>
                    <li><b>La deuxi√®me partie, c'est une petite description.</b> Elle donne une information sur un mot de la premi√®re partie.</li>
                </ul>
                 <p class="pt-2">Votre mission : trouver ces deux parties dans les phrases cor√©ennes ! üòâ</p>
            </div>
        </div>

        <!-- Exemple -->
        <div class="card p-6 mb-8 bg-blue-50 border border-blue-200">
            <h3 class="text-xl font-bold text-blue-800 mb-4">‚≠ê Exemple</h3>
            <p class="text-lg mb-4">Le livre que j‚Äôai achet√© est int√©ressant. / <span class="font-bold text-blue-700">ÎÇ¥Í∞Ä ÏÇ∞ Ï±ÖÏùÄ Ïû¨ÎØ∏ÏûàÏñ¥Ïöî.</span></p>
            <div class="space-y-3">
                <div>
                    <label class="font-semibold">1Ô∏è‚É£ Premi√®re partie :</label>
                    <p class="p-2 bg-gray-100 rounded-md mt-1">Ï±ÖÏùÄ Ïû¨ÎØ∏ÏûàÏñ¥Ïöî.</p>
                </div>
                <div>
                    <label class="font-semibold">2Ô∏è‚É£ Deuxi√®me partie :</label>
                    <p class="p-2 bg-gray-100 rounded-md mt-1">ÎÇ¥Í∞Ä ÏÇ∞</p>
                </div>
            </div>
        </div>


        <!-- Exercices -->
        <div class="space-y-6">
            <!-- Dynamically generated questions will be inserted here -->
        </div>

        <!-- Boutons d'action -->
        <div class="flex flex-wrap justify-center gap-4 mt-8">
            <button id="check-button" class="btn btn-primary"><i class="fas fa-check-circle mr-2"></i>V√©rifier les r√©ponses</button>
            <button id="finish-button" class="btn btn-gold"><i class="fas fa-paper-plane mr-2"></i>Terminer & Envoyer</button>
        </div>

        <!-- Section R√©sultat -->
        <div id="result-container" class="mt-8"></div>
        
        <!-- Boutons de navigation -->
        <div class="flex justify-between items-center mt-8 border-t pt-6">
            <button onclick="window.history.back();" class="btn btn-secondary"><i class="fas fa-arrow-left mr-2"></i>Exercice Pr√©c√©dent</button>
            <button onclick="window.print();" class="btn btn-secondary"><i class="fas fa-print mr-2"></i>Imprimer</button>
        </div>

    </div>

    <script>
        const questionsData = [
            { fr: "Le livre que j‚Äôai achet√© est int√©ressant.", ko: "ÎÇ¥Í∞Ä ÏÇ∞ Ï±ÖÏùÄ Ïû¨ÎØ∏ÏûàÏñ¥Ïöî." },
            { fr: "J‚Äôai rencontr√© une femme qui parle fran√ßais.", ko: "Ï†ÄÎäî ÌîÑÎûëÏä§Ïñ¥Î•º ÌïòÎäî Ïó¨ÏûêÎ•º ÎßåÎÇ¨Ïñ¥Ïöî." },
            { fr: "C‚Äôest la ville o√π je suis n√©.", ko: "Ïó¨Í∏∞Îäî Ï†úÍ∞Ä ÌÉúÏñ¥ÎÇú ÎèÑÏãúÏòàÏöî." },
            { fr: "Le film que tu as conseill√© √©tait super.", ko: "ÎÑ§Í∞Ä Ï∂îÏ≤úÌïú ÏòÅÌôîÎäî Ï†ïÎßê Ï¢ãÏïòÏñ¥." },
            { fr: "La personne dont je t‚Äôai parl√© est mon professeur.", ko: "ÎÇ¥Í∞Ä ÎÑàÏóêÍ≤å ÎßêÌñàÎçò ÏÇ¨ÎûåÏùÄ Ï†ú ÏÑ†ÏÉùÎãòÏù¥ÏóêÏöî." },
            { fr: "La nourriture que j'ai mang√©e hier √©tait d√©licieuse.", ko: "Ïñ¥Ï†ú Î®πÏùÄ ÏùåÏãùÏùÄ ÎßõÏûàÏóàÏñ¥Ïöî." },
            { fr: "Le cadeau que mon ami m'a donn√© est joli.", ko: "ÏπúÍµ¨Í∞Ä Ï§Ä ÏÑ†Î¨ºÏùÄ ÏòàÎªêÏöî." },
            { fr: "L'endroit o√π nous irons est S√©oul.", ko: "Ïö∞Î¶¨Í∞Ä Í∞à Í≥≥ÏùÄ ÏÑúÏö∏Ïù¥ÏóêÏöî." },
            { fr: "Le livre que je lis maintenant est difficile.", ko: "ÏßÄÍ∏à ÏùΩÎäî Ï±ÖÏùÄ Ïñ¥Î†§ÏõåÏöî." },
            { fr: "La personne qui vient l√†-bas est mon petit fr√®re.", ko: "Ï†ÄÍ∏∞ Ïò§Îäî ÏÇ¨ÎûåÏù¥ Ï†ú ÎèôÏÉùÏù¥ÏóêÏöî." },
            { fr: "Le chanteur que j'aime est BTS.", ko: "Ï†úÍ∞Ä Ï¢ãÏïÑÌïòÎäî Í∞ÄÏàòÎäî BTSÏòàÏöî." },
            { fr: "La salle de classe o√π les √©tudiants √©tudient est calme.", ko: "ÌïôÏÉùÎì§Ïù¥ Í≥µÎ∂ÄÌïòÎäî ÍµêÏã§ÏùÄ Ï°∞Ïö©Ìï¥Ïöî." },
            { fr: "Le canap√© sur lequel le chat dort est confortable.", ko: "Í≥†ÏñëÏù¥Í∞Ä ÏûêÎäî ÏÜåÌååÎäî Ìé∏ÏïàÌï¥Ïöî." },
            { fr: "Le film que nous avons vu hier √©tait triste.", ko: "Ïö∞Î¶¨Í∞Ä Ïñ¥Ï†ú Î≥∏ ÏòÅÌôîÎäî Ïä¨ÌéêÏñ¥Ïöî." },
            { fr: "Le g√¢teau que maman a fait est sucr√©.", ko: "ÏóÑÎßàÍ∞Ä ÎßåÎì† ÏºÄÏù¥ÌÅ¨Îäî Îã¨ÏΩ§Ìï¥Ïöî." },
            { fr: "Le v√©lo que papa m'a achet√© est rapide.", ko: "ÏïÑÎπ†Í∞Ä ÏÇ¨Ï£ºÏã† ÏûêÏ†ÑÍ±∞Îäî Îπ®ÎùºÏöî." },
            { fr: "Il y a une chanson que j'√©coute tous les jours.", ko: "Ï†úÍ∞Ä Îß§Ïùº Îì£Îäî ÎÖ∏ÎûòÍ∞Ä ÏûàÏñ¥Ïöî." },
            { fr: "La maison dans laquelle nous vivrons est grande.", ko: "Ïö∞Î¶¨Í∞Ä ÏÇ¥ ÏßëÏùÄ Ïª§Ïöî." },
            { fr: "Les v√™tements que je vais porter sont bleus.", ko: "Ï†úÍ∞Ä ÏûÖÏùÑ Ïò∑ÏùÄ ÌååÎûÄÏÉâÏù¥ÏóêÏöî." },
            { fr: "Le dessin que mon grand fr√®re a fait est cool.", ko: "ÌòïÏù¥ Í∑∏Î¶∞ Í∑∏Î¶ºÏùÄ Î©ãÏûàÏñ¥Ïöî." },
            { fr: "Le dessin anim√© que mon petit fr√®re regarde est amusant.", ko: "ÎèôÏÉùÏù¥ Î≥¥Îäî ÎßåÌôîÎäî Ïû¨ÎØ∏ÏûàÏñ¥Ïöî." },
            { fr: "L'heure √† laquelle nous nous rencontrerons est 3 heures.", ko: "Ïö∞Î¶¨Í∞Ä ÎßåÎÇ† ÏãúÍ∞ÑÏùÄ 3ÏãúÏòàÏöî." },
            { fr: "Il y a un caf√© o√π je vais souvent.", ko: "Ï†úÍ∞Ä ÏûêÏ£º Í∞ÄÎäî Ïπ¥ÌéòÍ∞Ä ÏûàÏñ¥Ïöî." },
            { fr: "La mati√®re que le professeur enseigne est l'histoire.", ko: "ÏÑ†ÏÉùÎãòÏù¥ Í∞ÄÎ•¥ÏπòÎäî Í≥ºÎ™©ÏùÄ Ïó≠ÏÇ¨ÏòàÏöî." },
            { fr: "J'ai trouv√© la cl√© que j'avais perdue.", ko: "Ï†úÍ∞Ä ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïó¥Ïá†Î•º Ï∞æÏïòÏñ¥Ïöî." },
            { fr: "J'ai fini de lire le livre que mon ami m'a pr√™t√©.", ko: "ÏπúÍµ¨Í∞Ä ÎπåÎ†§Ï§Ä Ï±ÖÏùÑ Îã§ ÏùΩÏóàÏñ¥Ïöî." },
            { fr: "Le bus que j'attends n'arrive pas.", ko: "Ï†úÍ∞Ä Í∏∞Îã§Î¶¨Îäî Î≤ÑÏä§Í∞Ä Ïïà ÏôÄÏöî." },
            { fr: "Regardez les gens qui dansent l√†-bas.", ko: "Ï†ÄÍ∏∞ÏÑú Ï∂§Ï∂îÎäî ÏÇ¨ÎûåÎì§ÏùÑ Î≥¥ÏÑ∏Ïöî." },
            { fr: "La photo que tu as prise est vraiment jolie.", ko: "ÎÑ§Í∞Ä Ï∞çÏùÄ ÏÇ¨ÏßÑÏùÄ Ï†ïÎßê ÏòàÎªê." },
            { fr: "J'ai envoy√© la lettre que j'ai √©crite hier.", ko: "Ï†úÍ∞Ä Ïñ¥Ï†ú Ïì¥ Ìé∏ÏßÄÎ•º Î≥¥ÎÉàÏñ¥Ïöî." }
        ];

        const answers = {
            q1: { part1: "Ï±ÖÏùÄ Ïû¨ÎØ∏ÏûàÏñ¥Ïöî.", part2: "ÎÇ¥Í∞Ä ÏÇ∞" },
            q2: { part1: "Ï†ÄÎäî Ïó¨ÏûêÎ•º ÎßåÎÇ¨Ïñ¥Ïöî.", part2: "ÌîÑÎûëÏä§Ïñ¥Î•º ÌïòÎäî" },
            q3: { part1: "Ïó¨Í∏∞Îäî ÎèÑÏãúÏòàÏöî.", part2: "Ï†úÍ∞Ä ÌÉúÏñ¥ÎÇú" },
            q4: { part1: "ÏòÅÌôîÎäî Ï†ïÎßê Ï¢ãÏïòÏñ¥.", part2: "ÎÑ§Í∞Ä Ï∂îÏ≤úÌïú" },
            q5: { part1: "Í∑∏ ÏÇ¨ÎûåÏùÄ Ï†ú ÏÑ†ÏÉùÎãòÏù¥ÏóêÏöî.", part2: "ÎÇ¥Í∞Ä ÎÑàÏóêÍ≤å ÎßêÌñàÎçò" },
            q6: { part1: "ÏùåÏãùÏùÄ ÎßõÏûàÏóàÏñ¥Ïöî.", part2: "Ïñ¥Ï†ú Î®πÏùÄ" },
            q7: { part1: "ÏÑ†Î¨ºÏùÄ ÏòàÎªêÏöî.", part2: "ÏπúÍµ¨Í∞Ä Ï§Ä" },
            q8: { part1: "Í≥≥ÏùÄ ÏÑúÏö∏Ïù¥ÏóêÏöî.", part2: "Ïö∞Î¶¨Í∞Ä Í∞à" },
            q9: { part1: "Ï±ÖÏùÄ Ïñ¥Î†§ÏõåÏöî.", part2: "ÏßÄÍ∏à ÏùΩÎäî" },
            q10: { part1: "Ï†Ä ÏÇ¨ÎûåÏùÄ Ï†ú ÎèôÏÉùÏù¥ÏóêÏöî.", part2: "Ï†ÄÍ∏∞ Ïò§Îäî" },
            q11: { part1: "Í∞ÄÏàòÎäî BTSÏòàÏöî.", part2: "Ï†úÍ∞Ä Ï¢ãÏïÑÌïòÎäî" },
            q12: { part1: "ÍµêÏã§ÏùÄ Ï°∞Ïö©Ìï¥Ïöî.", part2: "ÌïôÏÉùÎì§Ïù¥ Í≥µÎ∂ÄÌïòÎäî" },
            q13: { part1: "ÏÜåÌååÎäî Ìé∏ÏïàÌï¥Ïöî.", part2: "Í≥†ÏñëÏù¥Í∞Ä ÏûêÎäî" },
            q14: { part1: "ÏòÅÌôîÎäî Ïä¨ÌéêÏñ¥Ïöî.", part2: "Ïö∞Î¶¨Í∞Ä Ïñ¥Ï†ú Î≥∏" },
            q15: { part1: "ÏºÄÏù¥ÌÅ¨Îäî Îã¨ÏΩ§Ìï¥Ïöî.", part2: "ÏóÑÎßàÍ∞Ä ÎßåÎì†" },
            q16: { part1: "ÏûêÏ†ÑÍ±∞Îäî Îπ®ÎùºÏöî.", part2: "ÏïÑÎπ†Í∞Ä ÏÇ¨Ï£ºÏã†" },
            q17: { part1: "ÎÖ∏ÎûòÍ∞Ä ÏûàÏñ¥Ïöî.", part2: "Ï†úÍ∞Ä Îß§Ïùº Îì£Îäî" },
            q18: { part1: "ÏßëÏùÄ Ïª§Ïöî.", part2: "Ïö∞Î¶¨Í∞Ä ÏÇ¥" },
            q19: { part1: "Ïò∑ÏùÄ ÌååÎûÄÏÉâÏù¥ÏóêÏöî.", part2: "Ï†úÍ∞Ä ÏûÖÏùÑ" },
            q20: { part1: "Í∑∏Î¶ºÏùÄ Î©ãÏûàÏñ¥Ïöî.", part2: "ÌòïÏù¥ Í∑∏Î¶∞" },
            q21: { part1: "ÎßåÌôîÎäî Ïû¨ÎØ∏ÏûàÏñ¥Ïöî.", part2: "ÎèôÏÉùÏù¥ Î≥¥Îäî" },
            q22: { part1: "ÏãúÍ∞ÑÏùÄ 3ÏãúÏòàÏöî.", part2: "Ïö∞Î¶¨Í∞Ä ÎßåÎÇ†" },
            q23: { part1: "Ïπ¥ÌéòÍ∞Ä ÏûàÏñ¥Ïöî.", part2: "Ï†úÍ∞Ä ÏûêÏ£º Í∞ÄÎäî" },
            q24: { part1: "Í≥ºÎ™©ÏùÄ Ïó≠ÏÇ¨ÏòàÏöî.", part2: "ÏÑ†ÏÉùÎãòÏù¥ Í∞ÄÎ•¥ÏπòÎäî" },
            q25: { part1: "Ïó¥Ïá†Î•º Ï∞æÏïòÏñ¥Ïöî.", part2: "Ï†úÍ∞Ä ÏûÉÏñ¥Î≤ÑÎ¶∞" },
            q26: { part1: "Ï±ÖÏùÑ Îã§ ÏùΩÏóàÏñ¥Ïöî.", part2: "ÏπúÍµ¨Í∞Ä ÎπåÎ†§Ï§Ä" },
            q27: { part1: "Î≤ÑÏä§Í∞Ä Ïïà ÏôÄÏöî.", part2: "Ï†úÍ∞Ä Í∏∞Îã§Î¶¨Îäî" },
            q28: { part1: "ÏÇ¨ÎûåÎì§ÏùÑ Î≥¥ÏÑ∏Ïöî.", part2: "Ï†ÄÍ∏∞ÏÑú Ï∂§Ï∂îÎäî" },
            q29: { part1: "ÏÇ¨ÏßÑÏùÄ Ï†ïÎßê ÏòàÎªê.", part2: "ÎÑ§Í∞Ä Ï∞çÏùÄ" },
            q30: { part1: "Ìé∏ÏßÄÎ•º Î≥¥ÎÉàÏñ¥Ïöî.", part2: "Ï†úÍ∞Ä Ïñ¥Ï†ú Ïì¥" }
        };

        const studentData = {
            name: '',
            startTime: new Date(),
            endTime: null,
            score: 0,
            total: 30,
            incorrectAnswers: [],
            actions: []
        };

        function generateQuestions() {
            const container = document.querySelector('.space-y-6');
            let html = '';
            questionsData.forEach((q, index) => {
                const qId = `q${index + 1}`;
                html += `
                <div class="card p-6" id="${qId}">
                    <p class="text-lg mb-4"><b>Question ${index + 1}:</b> ${q.fr} / <span class="font-bold text-blue-700">${q.ko}</span></p>
                    <div class="space-y-3">
                        <div>
                            <label class="font-semibold">1Ô∏è‚É£ Premi√®re partie :</label>
                            <input type="text" data-part="1" class="mt-1">
                        </div>
                        <div>
                            <label class="font-semibold">2Ô∏è‚É£ Deuxi√®me partie :</label>
                            <input type="text" data-part="2" class="mt-1">
                        </div>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
        }

        document.addEventListener('DOMContentLoaded', generateQuestions);

        document.getElementById('student-name').addEventListener('change', (e) => {
            studentData.name = e.target.value;
            studentData.actions.push({ time: new Date(), action: 'entered_name', value: e.target.value });
        });

        const checkButton = document.getElementById('check-button');
        checkButton.addEventListener('click', () => {
            studentData.actions.push({ time: new Date(), action: 'click_check_answers' });
            checkAnswers();
        });
        
        function normalizeAnswer(str) {
            // A more flexible normalization
            return str.replace(/\s+/g, '').replace(/[.?!~,]/g, '').replace(/Í∑∏ÏÇ¨Îûå/g, 'ÏÇ¨Îûå');
        }

        function checkAnswers() {
            let correctCount = 0;
            studentData.incorrectAnswers = [];
            
            Object.keys(answers).forEach(qId => {
                const questionDiv = document.getElementById(qId);
                if (!questionDiv) return;

                const userPart1Input = questionDiv.querySelector('input[data-part="1"]');
                const userPart2Input = questionDiv.querySelector('input[data-part="2"]');

                const userPart1 = userPart1Input.value.trim();
                const userPart2 = userPart2Input.value.trim();
                
                const correctPart1 = answers[qId].part1;
                const correctPart2 = answers[qId].part2;

                // Allow for some flexibility in answers, e.g., with or without pronouns
                const normalizedUserPart1 = normalizeAnswer(userPart1);
                const normalizedCorrectPart1 = normalizeAnswer(correctPart1);
                const normalizedUserPart2 = normalizeAnswer(userPart2);
                const normalizedCorrectPart2 = normalizeAnswer(correctPart2);
                
                // Special case for q5 and q10 to be more flexible
                let altCorrectPart1_q5 = normalizeAnswer("ÏÇ¨ÎûåÏùÄ Ï†ú ÏÑ†ÏÉùÎãòÏù¥ÏóêÏöî.");
                let altCorrectPart1_q10 = normalizeAnswer("ÏÇ¨ÎûåÏùÄ Ï†ú ÎèôÏÉùÏù¥ÏóêÏöî.");

                let isPart1Correct = normalizedUserPart1 === normalizedCorrectPart1 || 
                                     (qId === 'q5' && normalizedUserPart1 === altCorrectPart1_q5) ||
                                     (qId === 'q10' && normalizedUserPart1 === altCorrectPart1_q10);
                let isPart2Correct = normalizedUserPart2 === normalizedCorrectPart2;

                userPart1Input.classList.remove('correct', 'incorrect');
                userPart2Input.classList.remove('correct', 'incorrect');

                userPart1Input.classList.add(isPart1Correct ? 'correct' : 'incorrect');
                userPart2Input.classList.add(isPart2Correct ? 'correct' : 'incorrect');

                if (isPart1Correct && isPart2Correct) {
                    correctCount++;
                } else {
                     studentData.incorrectAnswers.push({
                        question: qId,
                        userAnswer: `1: ${userPart1}, 2: ${userPart2}`,
                        correctAnswer: `1: ${correctPart1}, 2: ${correctPart2}`
                    });
                }
            });

            studentData.score = correctCount;
            displayResult(correctCount, studentData.total);
        }

        function displayResult(score, total) {
            const resultContainer = document.getElementById('result-container');
            const percentage = (score / total) * 100;
            let message = '';
            let bgColor = '';
            let textColor = '';
            let resultHTML = '';

            if (percentage === 100) {
                message = "ÏôÑÎ≤ΩÌï¥Ïöî!! üéâüëëüëç (Parfait !!)";
                bgColor = 'bg-green-100';
                textColor = 'text-green-800';
            } else if (percentage >= 80) {
                message = "ÏûòÌñàÏñ¥Ïöî!! üéâüëç (Bien jou√© !!)";
                bgColor = 'bg-blue-100';
                textColor = 'text-blue-800';
            } else if (percentage >= 60) {
                message = "ÍΩ§ ÏûòÌñàÏñ¥Ïöî. üëç (Assez bien.)";
                bgColor = 'bg-yellow-100';
                textColor = 'text-yellow-800';
            } else {
                message = "Îï°!! ÌãÄÎ†∏Ïñ¥Ïöî!! ÔøΩ (Incorrect !!)";
                bgColor = 'bg-red-100';
                textColor = 'text-red-800';
            }

            resultHTML = `<div id="result-message" class="${bgColor} ${textColor}">${message}</div>`;
            
            if (percentage < 100) {
                resultHTML += `<div class="mt-4 p-4 card">
                    <h3 class="font-bold text-lg mb-2">Corrections :</h3>
                    <ul class="list-disc list-inside space-y-2">`;
                
                studentData.incorrectAnswers.forEach(item => {
                    const questionText = document.querySelector('#' + item.question + ' p').innerText.split('/')[1].trim();
                    resultHTML += `<li>
                        <strong class="text-gray-700">${questionText}</strong><br>
                        <span class="text-red-600">Votre r√©ponse : ${item.userAnswer}</span><br>
                        <span class="text-green-600">R√©ponse correcte : ${item.correctAnswer}</span>
                    </li>`;
                });

                resultHTML += `</ul></div>`;
            }

            resultContainer.innerHTML = resultHTML;
        }

        const finishButton = document.getElementById('finish-button');
        finishButton.addEventListener('click', () => {
            if (!studentData.name) {
                alert("Veuillez entrer votre nom avant de terminer.");
                return;
            }
            checkAnswers(); // Final check before sending
            studentData.endTime = new Date();
            sendResults();
        });

        async function sendResults() {
            const timeTaken = (studentData.endTime - studentData.startTime) / 1000; // in seconds
            const payload = {
                studentName: studentData.name,
                exercise: "Structure de Phrase 1 (30 questions)",
                score: studentData.score,
                total: studentData.total,
                timeTaken: Math.round(timeTaken),
                incorrectAnswers: studentData.incorrectAnswers,
                actions: studentData.actions
            };
            
            studentData.actions.push({ time: new Date(), action: 'click_finish_send' });
            console.log("Sending results:", payload);

            try {
                // IMPORTANT: L'URL de l'API doit correspondre √† votre configuration Netlify
                const response = await fetch('/.netlify/functions/send-results', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    alert("R√©sultats envoy√©s avec succ√®s ! Merci !");
                    finishButton.disabled = true;
                    finishButton.innerText = "Envoy√© !";
                } else {
                    const error = await response.text();
                    throw new Error(`Erreur du serveur: ${error}`);
                }
            } catch (error) {
                console.error('Failed to send results:', error);
                alert("Une erreur est survenue lors de l'envoi des r√©sultats. Veuillez v√©rifier votre connexion ou contacter votre professeur.");
            }
        }
    </script>
</body>
</html>
ÔøΩ
